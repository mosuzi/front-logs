<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Front Logs</title>
    <!-- browser.js is generated by `npm run build:demo` -->
    <script defer src="browser.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="div">
      <button id="bind1">绑定1 bind1</button>
      <button id="append1">记录1 record1</button>
      <button id="send1">发送1 submit1</button>
    </div>

    <div class="div">
      <button id="bind2">绑定2 bind2</button>
      <button id="append2">记录2 record2</button>
      <button id="send2">发送2 submit2</button>
    </div>
    <div class="div">
      <button id="bind3">绑定3 bind3</button>
      <button id="append3">记录3 record3</button>
      <button id="send3">发送3 submit3</button>
    </div>
    <div class="div">
      <button id="bind4">绑定4 bind4</button>
      <button id="append4">记录4 record4</button>
      <button id="send4">发送4 submit4</button>
    </div>

    <script type="text/javascript">
      window.onload = function () {
        const FG = FrontLogs
        const logEngine = new FG.LogEngine()
        const handler1 = new FG.LogHandler()
        const handler2 = new FG.LogHandler()
        const handler3 = new FG.LogHandler()
        const handler4 = new FG.LogHandler()

        setClick(FG, handler1, 1, 'custom hhhh', 'http://127.0.0.1:3000', '/push/logs')
        setClick(FG, handler2, 2, '', 'http://127.0.0.1:2222') // fake request address
        setClick(FG, handler3, 3, 'custom hhhh', '', '/test3') // fake request address
        setClick(FG, handler4, 4)
      }

      function setClick(FG, handler, num, customLog, domain, url) {
        const bind = document.getElementById('bind' + num)
        bind.onclick = function () {
          handler.connect()
          const name = 'request' + num
          const request = handler.getRequest(name) || new FG.LogRequest(domain, url)
          handler.setRequest(request, name)
        }
        const append = document.getElementById('append' + num)
        append.onclick = function () {
          if (customLog) {
            const log = new FG.LogBean('custom', customLog)
            handler.appendCustomLog(log)
          } else {
            handler.appendLog('test' + num)
          }
        }
        const send = document.getElementById('send' + num)
        send.onclick = function () {
          handler.send()
        }
      }
    </script>
  </body>
</html>
